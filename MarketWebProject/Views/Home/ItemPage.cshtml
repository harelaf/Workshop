@model MainModel
@using MarketWeb.Shared.DTO
@using MarketWebProject.Views.Shared

@{
    @if (LayoutConfig.IsLoggedIn)
    {
        Layout = "~/Views/Shared/_LayoutLoggedIn.cshtml";
    }
    else if (LayoutConfig.IsAdmin)
    {
        Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_LayoutGuest.cshtml";
    }
    ViewData["Title"] = "Item Search Result";
}
<div class="text-center">
    <h1 class="display-4">Item @((ViewData["item"] as ItemDTO).Name) Page</h1>
    <br />
    <br />
</div>
<br />
<h1 style="font-size:200%;">Item Price:</h1>
<p style="font-size:160%;">$ @(String.Format("{0:0.00}", (ViewData["item"] as ItemDTO).Price))</p>
<br />
<h1 style="font-size:200%;">Item Category: </h1>
<p style="font-size:160%;"> @((ViewData["item"] as ItemDTO).Category)</p>
<br />
<h1 style="font-size:200%;">Item Description: </h1>
<p style="font-size:160%;"> @((ViewData["item"] as ItemDTO).Description)</p>
<div>
    <form method="post">
        <h1 style="font-size:200%;">Choose Amount To Add To Your Cart: </h1>
        <font color="black">Amount: </font>
        <input type="number" required min="1" name="amount" title="amount" id="amount" />
        <input class="btn btn-info" type="submit" value="Add To Cart" asp-area="" asp-controller="Home" asp-action="AddItemToCart" asp-route-amount="" asp-route-storename="@((ViewData["item"] as ItemDTO).StoreName)" asp-route-itemid="@((ViewData["item"] as ItemDTO).ItemID)" />
    </form>
</div>
<br />
<br />
<h1 style="font-size:200%;">Item Ratings and Comments: </h1>

@if ((ViewData["item"] as ItemDTO).Rating.Ratings.Count > 0)
{
    Dictionary<String, Tuple<int, String>> rating = (ViewData["item"] as ItemDTO).Rating.Ratings;
    <table class="table">
        <thead>
            <tr>
                <th>User name</th>
                <th>Rating Score</th>
                <th>Review</th>
            </tr>
        </thead>
        <tbody>
            @foreach (String userName in rating.Keys)
            {
                <tr>
                    <td>@userName</td>
                    <td>@rating[userName].Item1</td>
                    <td>@rating[userName].Item2</td>
                </tr>
            }
        <tbody />
    </table>
}
else
{
    <p style="font-size:160%;">no one has rated this item yet..</p>
}<br />
@if (LayoutConfig.IsLoggedIn || LayoutConfig.IsAdmin)
{ 
    <h5>Add Your Review: </h5>
    <form method="post"  id="usrform">
        <div width: 20%;>
            <p>Please pick a rating:</p>
            <input type="range" id="rating" name="rating" title="rating"  min="0" max="10" value="5" oninput="this.nextElementSibling.value = this.value">
            <output>5</output>
        </div>
        <br />
        <textarea rows="2" cols="50"  id="comment" name="comment" form="usrform"> Enter comment here...</textarea>
    <br />
        <input class="btn btn-info" type="submit" value="Add" asp-area="" asp-controller="Home" 
            asp-action="AddItemReview" asp-route-newQuantity="" 
            asp-route-itemId="@((ViewData["item"] as ItemDTO).ItemID)"
            asp-route-storeName="@((ViewData["item"] as ItemDTO).StoreName)"/>
    </form>
}
